name: Update My Config

on:
  schedule:
    - cron: "*/2 * * * *"
  workflow_dispatch:

jobs:
  update-config:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Update file
        run: |
          # –°–∫–∞—á–∏–≤–∞–µ–º –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
          curl -s https://raw.githubusercontent.com/igareck/vpn-configs-for-russia/refs/heads/main/Vless-Reality-White-Lists-Rus-Mobile.txt | tail -n +3 > my_config.txt
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
          echo "‚úÖ –§–∞–π–ª –æ–±–Ω–æ–≤–ª–µ–Ω. –°—Ç—Ä–æ–∫: $(wc -l < my_config.txt)"
          echo "üìÖ –í—Ä–µ–º—è: $(date)"
      
      - name: Push to repository
        run: |
          git config user.name "Update-Bot"
          git config user.email "bot@localhost"
          git add my_config.txt
          git commit -m "Update: $(date +'%Y-%m-%d %H:%M')"
          git push
