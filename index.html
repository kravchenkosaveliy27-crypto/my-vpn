<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <title>67 VPN</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Inter", sans-serif;
            min-height: 100vh;
            background: #060606;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .card {
            padding: 32px;
            background-color: #0f1322;
            color: #ffffff;
            border-radius: 32px;
            width: 100%;
            max-width: 420px;
            border: 1px solid #2a2a3a;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            background: #1a61f2;
            width: 44px;
            height: 44px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.4rem;
            color: white;
            box-shadow: 0 4px 10px rgba(26,97,242,0.3);
        }

        .vpn-name {
            font-size: 1.3rem;
            font-weight: 600;
            background: linear-gradient(135deg, #f0f3ff, #cddaff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .free-badge {
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 50px;
            padding: 0.2rem 0.8rem;
            font-size: 0.7rem;
            color: #ffd966;
            margin-left: 10px;
            display: inline-block;
        }

        .status-badge {
            background: rgba(0, 210, 110, 0.12);
            border: 1px solid rgba(0, 230, 120, 0.3);
            border-radius: 50px;
            padding: 0.4rem 1rem;
            font-size: 0.8rem;
            color: #1fe88e;
            backdrop-filter: blur(4px);
            font-weight: 500;
        }

        .status-badge.inactive {
            background: rgba(255, 70, 70, 0.12);
            border: 1px solid rgba(255, 70, 70, 0.3);
            color: #ff6b6b;
        }

        .info-grid {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
            margin: 1.5rem 0;
            background: #1a1e30;
            padding: 20px;
            border-radius: 20px;
        }

        .info-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
            padding-bottom: 8px;
        }

        .info-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .info-label {
            font-size: 0.9rem;
            font-weight: 400;
            color: #8892b8;
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: 500;
            color: #ffffff;
        }

        .time-remaining {
            background: #1b1f32;
            border-radius: 40px;
            padding: 16px 22px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 2px solid #2f3c70;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .remaining-label {
            font-size: 18px;
            font-weight: 500;
            color: #b9c2e0;
        }

        .remaining-days {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #fff, #b7ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .servers-btn {
            background: linear-gradient(145deg, #0f1a2f, #1a2a4a);
            border-radius: 40px;
            padding: 16px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border: 1px solid #3a4f8a;
            margin-top: 12px;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(58,79,138,0.3);
        }

        .servers-btn span {
            font-size: 16px;
            font-weight: 500;
            color: #b8d0ff;
        }

        .servers-btn:active {
            transform: scale(0.98);
            background: #1a2a4a;
        }

        .instruction-btn {
            background: #0a0a12;
            border-radius: 40px;
            padding: 16px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            border: 1px solid #2a2a3a;
            margin-top: 12px;
            transition: all 0.2s;
        }

        .instruction-btn:active {
            transform: scale(0.98);
            background: #1a1a24;
        }

        .instruction-btn span {
            font-size: 16px;
            color: #ffffff;
        }

        .servers-arrow, .instruction-arrow {
            background: #1e2f4a;
            width: 38px;
            height: 38px;
            border-radius: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8ab2ff;
            border: 1px solid #4a6bb0;
            font-size: 20px;
        }
        
        .refresh-btn {
            background: #1e2a3a;
            border: none;
            color: #8ab2ff;
            padding: 12px 20px;
            border-radius: 30px;
            margin-top: 20px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid #3a4f8a;
        }
        
        .refresh-btn:active {
            transform: scale(0.98);
            background: #2a3a4a;
        }
    </style>
</head>
<body>

<div class="card">
    <div class="card-header">
        <div class="logo-area">
            <div class="logo-icon">67</div>
            <div class="vpn-name">VPN</div>
            <span class="free-badge" id="free-badge">FREE</span>
        </div>
        <div class="status-badge" id="status-badge">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div class="info-grid">
        <div class="info-row">
            <span class="info-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
            <span class="info-value" id="username">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</span>
            <span class="info-value" id="expiry-date">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">–õ–∏–º–∏—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤</span>
            <span class="info-value" id="devices-limit">1</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">–û—Å—Ç–∞–ª–æ—Å—å</span>
            <span class="info-value" id="days-left">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <div class="time-remaining">
        <span class="remaining-label">–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π</span>
        <span class="remaining-days" id="remaining-time">--</span>
    </div>

    <!-- –ö–ù–û–ü–ö–ê –ü–û–õ–£–ß–ï–ù–ò–Ø –ü–û–î–ü–ò–°–ö–ò -->
    <div class="servers-btn" id="servers-btn">
        <span>üöÄ –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É VLESS</span>
        <div class="servers-arrow">‚Üí</div>
    </div>

    <div class="instruction-btn" id="instruction-btn">
        <span>üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</span>
        <div class="instruction-arrow">‚Üí</div>
    </div>
    
    <button class="refresh-btn" id="refresh-btn">
        üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
    </button>
</div>

<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();
    
    console.log('üöÄ Mini App –∑–∞–ø—É—â–µ–Ω');
    
    // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
    const urlParams = new URLSearchParams(window.location.search);
    let userId = urlParams.get('user_id');
    const urlName = urlParams.get('name');
    const urlExpiry = urlParams.get('expiry');
    const urlDays = urlParams.get('days');
    const urlDevices = urlParams.get('devices') || '1';
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è FREE –±–µ–π–¥–∂–∞
    function updateFreeBadge(daysLeft, isTrial) {
        const freeBadge = document.getElementById('free-badge');
        if (!freeBadge) return;
        
        if (parseInt(daysLeft) === 0 || isTrial === true) {
            freeBadge.style.display = 'inline-block';
        } else {
            freeBadge.style.display = 'none';
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function updateUI(data) {
        document.getElementById('username').textContent = data.username || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
        document.getElementById('expiry-date').textContent = data.expiry || '--.--.--';
        document.getElementById('days-left').textContent = (data.daysLeft || '0') + ' –¥–Ω–µ–π';
        document.getElementById('remaining-time').textContent = (data.daysLeft || '0') + ' –¥–Ω.';
        document.getElementById('devices-limit').textContent = data.devices || '1';
        
        const statusBadge = document.getElementById('status-badge');
        const daysLeftNum = parseInt(data.daysLeft || '0');
        const isTrial = data.isTrial === true || data.isTrial === 'true';
        
        if (daysLeftNum > 0) {
            statusBadge.textContent = '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω';
            statusBadge.classList.remove('inactive');
        } else {
            statusBadge.textContent = '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω';
            statusBadge.classList.add('inactive');
        }
        
        updateFreeBadge(daysLeftNum, isTrial);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
    function loadStatus() {
        if (!userId) {
            updateUI({
                username: urlName || '–ì–æ—Å—Ç—å',
                expiry: urlExpiry || '--.--.--',
                daysLeft: urlDays || '0',
                devices: urlDevices,
                isTrial: true
            });
            return;
        }
        
        if (urlExpiry && urlDays) {
            const daysNum = parseInt(urlDays);
            const isTrial = daysNum <= 3 || urlDays === '3';
            
            updateUI({
                username: urlName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                expiry: urlExpiry,
                daysLeft: urlDays,
                devices: urlDevices,
                isTrial: isTrial
            });
        } else {
            updateUI({
                username: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                expiry: '--.--.--',
                daysLeft: '0',
                devices: '1',
                isTrial: true
            });
        }
    }
    
    loadStatus();
    
    // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    document.getElementById('refresh-btn').onclick = () => {
        loadStatus();
        if (tg) tg.HapticFeedback.impactOccurred('light');
    };
    
    // –ö–Ω–æ–ø–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    document.getElementById('instruction-btn').onclick = () => {
        const message = 'üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:\n1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ HAPP\n2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"';
        if (tg) tg.showAlert(message);
    };
    
    // === –ö–ù–û–ü–ö–ê –ü–û–õ–£–ß–ï–ù–ò–Ø –ü–û–î–ü–ò–°–ö–ò (–ü–†–ê–í–ò–õ–¨–ù–´–ô –ò–ú–ü–û–†–¢ –í HAPP) ===
    document.getElementById('servers-btn').onclick = () => {
        // –í–ê–®–ê –ü–†–Ø–ú–ê–Ø –°–°–´–õ–ö–ê –ù–ê –§–ê–ô–õ
        const yourFileUrl = 'https://raw.githubusercontent.com/zieng2/wl/refs/heads/main/vless_lite.txt';
        
        // –§–û–†–ú–ò–†–£–ï–ú –ü–†–ê–í–ò–õ–¨–ù–£–Æ –°–°–´–õ–ö–£ –î–õ–Ø HAPP
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç-—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ HAPP
        const happyUrl = `https://add.takovpn.ru/redirect_app?target=happ://crypt4/${encodeURIComponent(yourFileUrl)}`;
        
        console.log('üöÄ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ HAPP:', happyUrl);
        
        if (tg) {
            tg.openLink(happyUrl, { try_instant_view: false });
            tg.HapticFeedback.impactOccurred('medium');
        } else {
            window.open(happyUrl, '_blank');
        }
    };
    
    setInterval(loadStatus, 5000);
</script>

</body>
</html>
